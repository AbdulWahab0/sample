<!DOCTYPE>

<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>cytoscape-edgehandles.js demo</title>

    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">

    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
    <script src="/js/application.js" th:src="@{/js/cytoscape-edgehandles.js}"></script>

    <!-- for testing with local version of cytoscape.js -->
    <!--<script src="../cytoscape.js/build/cytoscape.js"></script>-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.10/lodash.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>


    <style>
      body {
        font-family: helvetica neue, helvetica, liberation sans, arial, sans-serif;
        font-size: 14px;
      }
      #cy {
        position: absolute;
        left:121px;
        top: 0;
        bottom: 0;
        right: 0;
        z-index: 999;
      }
      h1 {
        opacity: 0.5;
        font-size: 1em;
        font-weight: bold;
      }
      #buttons {
        position: absolute;
        right: 0;
        bottom: 0;
        z-index: 99999;
      }
    </style>


    <div th:replace="template::stylesheet">
    </div>
    <script>
$.getJSON("/newapplication-graph", function (data) {
      document.addEventListener('DOMContentLoaded', function(){
        var cy = window.cy = cytoscape({
          container: document.getElementById('cy'),
          layout: {
            name: 'concentric',
            concentric: function(n){ return n.id() === 'j' ? 200 : 0; },
            levelWidth: function(nodes){ return 100; },
            minNodeSpacing: 50
          },
          style: [
            {
              selector: 'node',
              style: {

               'width': '3px',
               'font-size':'5px',
               'height': '3px',
                'content': 'data'
              }
            },

            {
              selector: 'edge',
              style: {
                'curve-style': 'bezier',
                'width':'0.3',
                'arrow-scale':'.2',
                'target-arrow-shape': 'triangle'
              }
            },


            // some style for the extension
            {
              selector: '.eh-handle',
              style: {
                'background-color': 'red',
                'width': 2,
                'height': 2,
                'font-size':'1px',
                'shape': 'ellipse',
                'overlay-opacity': 0,
                'border-width': 2, // makes the handle easier to hit
                'border-opacity': 0
              }
            },
            {
              selector: '.eh-hover',
              style: {
                'background-color': 'red',
                'width': '5px',
                'height': '5px'

              }
            },
            {
              selector: '.eh-source',
              style: {
                'border-width': 1,


              }
            },
            {
              selector: '.eh-target',
              style: {
                'border-width': 1

              }
            },
            {
              selector: '.eh-preview, .eh-ghost-edge',
              style: {
                'background-color': 'red',
                'line-color': 'black',

                'target-arrow-color': 'red',
                'source-arrow-color': 'red'
              }
            },
            {
              selector: '.eh-ghost-edge.eh-preview-active',
              style: {
              'border-width': 1,
                'opacity': 0,
              }
            }
          ],
          elements:data
        });
        cy.nodes().style({"font-size": 4});
        var eh = cy.edgehandles({
        snap: true
        });
        document.querySelector('#draw-on').addEventListener('click', function() {
          eh.enableDrawMode();
        });
        document.querySelector('#draw-off').addEventListener('click', function() {
          eh.disableDrawMode();
        });
        document.querySelector('#start').addEventListener('click', function() {
          eh.start( cy.$('node:selected') );
        });
        });
});

    </script>
</head>
<script>
$.getJSON("/newapplication-graph", function (data) {
      document.addEventListener('DOMContentLoaded', function(){
        var cy = window.cy = cytoscape({
          container: document.getElementById('cy'),
          layout: {
            name: 'concentric',
            concentric: function(n){ return n.id() === 'j' ? 200 : 0; },
            levelWidth: function(nodes){ return 100; },
            minNodeSpacing: 50
          },
          style: [
            {
              selector: 'node',
              style: {

               'width': '3px',
               'font-size':'5px',
               'height': '3px',
                'content': 'data'
              }
            },

            {
              selector: 'edge',
              style: {
                'curve-style': 'bezier',
                'width':'0.3',
                'arrow-scale':'.2',
                'target-arrow-shape': 'triangle'
              }
            },


            // some style for the extension
            {
              selector: '.eh-handle',
              style: {
                'background-color': 'red',
                'width': 2,
                'height': 2,
                'font-size':'1px',
                'shape': 'ellipse',
                'overlay-opacity': 0,
                'border-width': 2, // makes the handle easier to hit
                'border-opacity': 0
              }
            },
            {
              selector: '.eh-hover',
              style: {
                'background-color': 'red',
                'width': '5px',
                'height': '5px'

              }
            },
            {
              selector: '.eh-source',
              style: {
                'border-width': 1,


              }
            },
            {
              selector: '.eh-target',
              style: {
                'border-width': 1

              }
            },
            {
              selector: '.eh-preview, .eh-ghost-edge',
              style: {
                'background-color': 'red',
                'line-color': 'black',

                'target-arrow-color': 'red',
                'source-arrow-color': 'red'
              }
            },
            {
              selector: '.eh-ghost-edge.eh-preview-active',
              style: {
              'border-width': 1,
                'opacity': 0,
              }
            }
          ],
          elements:data
        });
        cy.nodes().style({"font-size": 4});
        var eh = cy.edgehandles({
        snap: true
        });
        document.querySelector('#draw-on').addEventListener('click', function() {
          eh.enableDrawMode();
        });
        document.querySelector('#draw-off').addEventListener('click', function() {
          eh.disableDrawMode();
        });
        document.querySelector('#start').addEventListener('click', function() {
          eh.start( cy.$('node:selected') );
        });
        });
});

    </script>

<body class="skin-blue">
<div class="wrapper">
    <div th:replace="template::topmenu"></div>
    <div th:replace="template::main-sidebar"></div>
    <div class="content-wrapper">
        <section  style="margin-top: -15px; margin-left: 23px; margin-right: 11px;"id="main">

            <h5>
                / <a href="/application">application</a>
            </h5>
            <h3>Applications<br/>
                <small>Application template</small>
            </h3>


            <div id="cy"></div>

            <div class="metabox" style="margin-top: 12px;margin-right: 17px;">
                <input id="txtarea" class="form-control" rows="7" cols="40" type="hidden"></input>
                <div class="form-item" style="color:#eee">
                    <select   class="form-control" id="componentsList">
                        <option>-----</option>
                        <option>Ping Pong</option>
                        <option>New Ping Pong</option>
                    </select>
                    <br/>
                    <button type="button" class="btn btn-success btn-block" onclick="addNewComp();">Add Component</button>
                    <br/>
                    <input data-model="configure" data-name="sgid"  type="hidden" id="sgid"/>
                    <input type="hidden" class="form-control" name="nodeID" id="nodeID" placeholder="NID"  readonly="readonly"/>
                    <input type="hidden" class="form-control" name="nodeCNID" id="nodeCNID" placeholder="NCID"   readonly="readonly"/>
                    <label for="nodeName">Selected Component </label>
                    <input type="text" class="form-control" name="nodeName" id="nodeName" placeholder="splaceholder=e.g. sregw"   readonly="readonly"/>
                    <br/>
                    <div id="info" style="display: none;" class="panel"> </div>
                    <div id="request"></div>
                </div>
                <br/>
                <div class="form-item">
                    <div class="action-area">
                        <label for="sgName">Template Name</label>
                        <input type="text" id="sgName" name="sgName"
                               class="form-control" placeholder="e.g. Service Graph 1"
                               autocomplete="off"/>
                        <br/>
                        <button id="save" type="button" class="btn btn-danger btn-block" onclick="saveJSON();">Save</button>
                        <button id="refresh" type="button" class="btn btn-default btn-block" onclick="refresh();">Reload</button>
                    </div>
                </div>
            </div>

        </section>
    </div>
    <div th:replace="template::footer"></div>
</div>
<div th:replace="template::script"></div>
</body>

</html>
